<p id="notice"><%= notice %></p>

<h1>Welcome Admin!</h1>
<br>
<h3><em>Merchants Dashboard</em></h3>

<table class="table table-light">
  <thead>
    <tr>
      <th colspan="2"></th>
    </tr>
  </thead>
  <tbody>
    <% @merchants.each_with_index do |merchant, idx| %>
      <tr id="merchant-<%= merchant.id %>">
        <th><%= link_to "#{merchant.name}", admin_merchant_path(merchant.id) %></th>
        <th><%= link_to 'Edit Merchant', edit_admin_merchant_path(merchant.id) %></th>
      </tr>
      <tr>
        <th><em>Top Customers</em></th>
        <th></th>
      </tr>
        <tr>
          <td colspan="3">
            <table class="table mb-0 table-striped">
              <tr id="customer-table-headers">
                <th class="table-info">Customer Rank:</th>
                <th class="table-info">Customer Name:</th>
                <th class="table-info">Total Purchases:</th>
              </tr>
              <tr id="merchant-top-customers-<%= merchant.id %>">
                <% Customer.top_customers_for_merchant(merchant.id).each_with_index do |customer, idx| %>
                  <tr id="customer-<%= customer.id %>">
                    <td><%= "#{idx + 1}" %></td>
                    <td><%= "#{customer.first_name} #{customer.last_name}" %></td>
                    <td><%= "#{customer.transaction_count}" %></td>
                  </tr>
                <% end %>
              </tr>
             </table>
             <br>
           </td>
        </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Admin Merchant', new_admin_merchant_path %>
